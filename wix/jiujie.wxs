<?xml version='1.0' encoding='utf-8'?>
<!--
  Source: https://github.com/peterfei/bevy_card_battler
  Game: 九界：渡劫 (Jiujie: Dujie)
-->

<Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'>
    <Product Id='*' Name='九界：渡劫' UpgradeCode='F50F4705-932B-4FF5-A3E6-34285FC6E6BD' Manufacturer='PeterFei' Language='2052' Codepage='936' Version='0.1.0'>
        <Package Id='*' Keywords='Installer' Description='九界：渡劫 - 修仙肉鸽卡牌游戏' Manufacturer='PeterFei' InstallerVersion='450' Languages='2052' Compressed='yes' InstallScope='perMachine' SummaryCodepage='936' Platform='x64'/>

        <MajorUpgrade Schedule='afterInstallInitialize' DowngradeErrorMessage='已安装更高版本的 [ProductName]。安装程序将退出。'/>

        <Media Id='1' Cabinet='media1.cab' EmbedCab='yes' DiskPrompt='光盘 #1'/>
        <Property Id='DiskPrompt' Value='九界：渡劫 安装程序 [1]'/>

        <Directory Id='TARGETDIR' Name='SourceDir'>
            <Directory Id='ProgramFiles64Folder' Name='PFiles'>
                <Directory Id='APPLICATIONFOLDER' Name='Jiujie'>
                    
                    <!-- 主程序 -->
                    <Component Id='binary0' Guid='191E9B73-F5AD-4554-9D60-4805BF571B55' Win64='yes'>
                        <File Id='exe0' Name='jiujie.exe' DiskId='1' Source='$(var.CargoTargetBinDir)\jiujie.exe' KeyPath='yes'/>
                    </Component>

                    <!-- 许可文件 -->
                    <Component Id='License' Guid='635CC59F-86E8-423B-9176-FF483E104B64' Win64='yes'>
                        <File Id='LicenseFile' Name='License.rtf' DiskId='1' Source='wix\License.rtf' KeyPath='yes'/>
                    </Component>
                </Directory>
            </Directory>
            
            <!-- 开始菜单快捷方式 -->
            <Directory Id="ProgramMenuFolder">
                <Directory Id="ApplicationProgramsFolder" Name="九界：渡劫"/>
            </Directory>
        </Directory>

        <DirectoryRef Id="ApplicationProgramsFolder">
            <Component Id="ApplicationShortcut" Guid="*">
                <Shortcut Id="ApplicationStartMenuShortcut" 
                          Name="九界：渡劫" 
                          Description="开始修行《九界：渡劫》"
                          Target="[APPLICATIONFOLDER]jiujie.exe"
                          WorkingDirectory="APPLICATIONFOLDER"/>
                <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall"/>
                <RegistryValue Root="HKCU" Key="Software\PeterFei\Jiujie" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
            </Component>
        </DirectoryRef>

        <Feature Id='MainProgram' Title='九界：渡劫' Description='安装游戏主程序' Level='1' ConfigurableDirectory='APPLICATIONFOLDER' AllowAdvertise='no' Display='expand' Absent='disallow'>
            <ComponentRef Id='binary0'/>
            <ComponentRef Id='License'/>
            <ComponentRef Id='ApplicationShortcut'/>
        </Feature>

        <SetProperty Id='ARPINSTALLLOCATION' Value='[APPLICATIONFOLDER]' After='CostFinalize'/>

        <!-- 图标 -->
        <Icon Id='ProductICO' SourceFile='assets\icons\favicon.ico'/>
        <Property Id='ARPPRODUCTICON' Value='ProductICO' />

        <!-- UI -->
        <UIRef Id='WixUI_InstallDir'/>
        <Property Id='WIXUI_INSTALLDIR' Value='APPLICATIONFOLDER'/>
        <WixVariable Id='WixUILicenseRtf' Value='wix\License.rtf'/>

    </Product>
</Wix>
